const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-C39EA6f3.js","assets/index-DvdqrpFL.js","assets/index-DIdTTaAh.css","assets/browser-BFTG0pCe.js"])))=>i.map(i=>d[i]);
import{c as ee,r as m,u as dt,j as e,h as mt,l as Q,i as re,k as te,m as ge,_ as Ee,B as U,A as ut,v as $,C as _e,a as ht,e as xt,f as ft,b as ye,g as De,w as pt,J as gt,x as yt,y as jt,z as vt,G as wt,W as bt}from"./index-DvdqrpFL.js";import{I as ne,L as V}from"./label-x0QtSfq_.js";import{h as Ge,S as ce,a as le,b as de,c as me,d as E}from"./select-Rrx5v8JA.js";import{T as St,a as Nt,b as Ae,c as Ie}from"./tabs-DhxU4bmi.js";import{S as kt}from"./switch-X7y7Ooe4.js";import{c as Ct,b as Pt,a as Tt,u as Mt}from"./index-Cu9qe0MP.js";import{g as Et}from"./security-CQiw_mJQ.js";import{s as _t}from"./client-B0adUgEe.js";import{g as Dt,a as At,c as Re}from"./seasonal-CKgZBBys.js";import{M as je}from"./map-pin-MllDBAsa.js";import{C as $e}from"./calendar-BXrtHmHt.js";import{S as It}from"./shield-S7aQxEnY.js";import{C as Rt}from"./clock-BYHCebaK.js";import{T as Fe}from"./ticket-BC-FGhCl.js";import{P as $t}from"./plus-SKjyWRtt.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ft=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],Lt=ee("credit-card",Ft);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zt=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],Le=ee("funnel",zt);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bt=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],ze=ee("info",Bt);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kt=[["path",{d:"M5 12h14",key:"1ays0h"}]],Gt=ee("minus",Kt);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],Be=ee("search",Ut);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vt=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Ht=ee("star",Vt);var Ue=["PageUp","PageDown"],Ve=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],He={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},se="Slider",[ve,Ot,Wt]=Ct(se),[Oe]=mt(se,[Wt]),[qt,ue]=Oe(se),We=m.forwardRef((t,a)=>{const{name:i,min:s=0,max:o=100,step:l=1,orientation:d="horizontal",disabled:c=!1,minStepsBetweenThumbs:g=0,defaultValue:f=[s],value:k,onValueChange:r=()=>{},onValueCommit:u=()=>{},inverted:y=!1,form:v,...p}=t,w=m.useRef(new Set),j=m.useRef(0),N=d==="horizontal"?Yt:Jt,[b=[],D]=dt({prop:k,defaultProp:f,onChange:T=>{[...w.current][j.current]?.focus(),r(T)}}),W=m.useRef(b);function L(T){const I=ts(b,T);F(T,I)}function ie(T){F(T,j.current)}function K(){const T=W.current[j.current];b[j.current]!==T&&u(b)}function F(T,I,{commit:q}={commit:!1}){const Y=rs(l),_=is(Math.round((T-s)/l)*l+s,Y),z=Ge(_,[s,o]);D((A=[])=>{const M=Qt(A,z,I);if(ns(M,g*l)){j.current=M.indexOf(z);const J=String(M)!==String(A);return J&&q&&u(M),J?M:A}else return A})}return e.jsx(qt,{scope:t.__scopeSlider,name:i,disabled:c,min:s,max:o,valueIndexToChangeRef:j,thumbs:w.current,values:b,orientation:d,form:v,children:e.jsx(ve.Provider,{scope:t.__scopeSlider,children:e.jsx(ve.Slot,{scope:t.__scopeSlider,children:e.jsx(N,{"aria-disabled":c,"data-disabled":c?"":void 0,...p,ref:a,onPointerDown:Q(p.onPointerDown,()=>{c||(W.current=b)}),min:s,max:o,inverted:y,onSlideStart:c?void 0:L,onSlideMove:c?void 0:ie,onSlideEnd:c?void 0:K,onHomeKeyDown:()=>!c&&F(s,0,{commit:!0}),onEndKeyDown:()=>!c&&F(o,b.length-1,{commit:!0}),onStepKeyDown:({event:T,direction:I})=>{if(!c){const _=Ue.includes(T.key)||T.shiftKey&&Ve.includes(T.key)?10:1,z=j.current,A=b[z],M=l*_*I;F(A+M,z,{commit:!0})}}})})})})});We.displayName=se;var[qe,Ye]=Oe(se,{startEdge:"left",endEdge:"right",size:"width",direction:1}),Yt=m.forwardRef((t,a)=>{const{min:i,max:s,dir:o,inverted:l,onSlideStart:d,onSlideMove:c,onSlideEnd:g,onStepKeyDown:f,...k}=t,[r,u]=m.useState(null),y=te(a,N=>u(N)),v=m.useRef(void 0),p=Pt(o),w=p==="ltr",j=w&&!l||!w&&l;function x(N){const b=v.current||r.getBoundingClientRect(),D=[0,b.width],L=Se(D,j?[i,s]:[s,i]);return v.current=b,L(N-b.left)}return e.jsx(qe,{scope:t.__scopeSlider,startEdge:j?"left":"right",endEdge:j?"right":"left",direction:j?1:-1,size:"width",children:e.jsx(Je,{dir:p,"data-orientation":"horizontal",...k,ref:y,style:{...k.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:N=>{const b=x(N.clientX);d?.(b)},onSlideMove:N=>{const b=x(N.clientX);c?.(b)},onSlideEnd:()=>{v.current=void 0,g?.()},onStepKeyDown:N=>{const D=He[j?"from-left":"from-right"].includes(N.key);f?.({event:N,direction:D?-1:1})}})})}),Jt=m.forwardRef((t,a)=>{const{min:i,max:s,inverted:o,onSlideStart:l,onSlideMove:d,onSlideEnd:c,onStepKeyDown:g,...f}=t,k=m.useRef(null),r=te(a,k),u=m.useRef(void 0),y=!o;function v(p){const w=u.current||k.current.getBoundingClientRect(),j=[0,w.height],N=Se(j,y?[s,i]:[i,s]);return u.current=w,N(p-w.top)}return e.jsx(qe,{scope:t.__scopeSlider,startEdge:y?"bottom":"top",endEdge:y?"top":"bottom",size:"height",direction:y?1:-1,children:e.jsx(Je,{"data-orientation":"vertical",...f,ref:r,style:{...f.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:p=>{const w=v(p.clientY);l?.(w)},onSlideMove:p=>{const w=v(p.clientY);d?.(w)},onSlideEnd:()=>{u.current=void 0,c?.()},onStepKeyDown:p=>{const j=He[y?"from-bottom":"from-top"].includes(p.key);g?.({event:p,direction:j?-1:1})}})})}),Je=m.forwardRef((t,a)=>{const{__scopeSlider:i,onSlideStart:s,onSlideMove:o,onSlideEnd:l,onHomeKeyDown:d,onEndKeyDown:c,onStepKeyDown:g,...f}=t,k=ue(se,i);return e.jsx(re.span,{...f,ref:a,onKeyDown:Q(t.onKeyDown,r=>{r.key==="Home"?(d(r),r.preventDefault()):r.key==="End"?(c(r),r.preventDefault()):Ue.concat(Ve).includes(r.key)&&(g(r),r.preventDefault())}),onPointerDown:Q(t.onPointerDown,r=>{const u=r.target;u.setPointerCapture(r.pointerId),r.preventDefault(),k.thumbs.has(u)?u.focus():s(r)}),onPointerMove:Q(t.onPointerMove,r=>{r.target.hasPointerCapture(r.pointerId)&&o(r)}),onPointerUp:Q(t.onPointerUp,r=>{const u=r.target;u.hasPointerCapture(r.pointerId)&&(u.releasePointerCapture(r.pointerId),l(r))})})}),Xe="SliderTrack",Ze=m.forwardRef((t,a)=>{const{__scopeSlider:i,...s}=t,o=ue(Xe,i);return e.jsx(re.span,{"data-disabled":o.disabled?"":void 0,"data-orientation":o.orientation,...s,ref:a})});Ze.displayName=Xe;var we="SliderRange",Qe=m.forwardRef((t,a)=>{const{__scopeSlider:i,...s}=t,o=ue(we,i),l=Ye(we,i),d=m.useRef(null),c=te(a,d),g=o.values.length,f=o.values.map(u=>st(u,o.min,o.max)),k=g>1?Math.min(...f):0,r=100-Math.max(...f);return e.jsx(re.span,{"data-orientation":o.orientation,"data-disabled":o.disabled?"":void 0,...s,ref:c,style:{...t.style,[l.startEdge]:k+"%",[l.endEdge]:r+"%"}})});Qe.displayName=we;var be="SliderThumb",et=m.forwardRef((t,a)=>{const i=Ot(t.__scopeSlider),[s,o]=m.useState(null),l=te(a,c=>o(c)),d=m.useMemo(()=>s?i().findIndex(c=>c.ref.current===s):-1,[i,s]);return e.jsx(Xt,{...t,ref:l,index:d})}),Xt=m.forwardRef((t,a)=>{const{__scopeSlider:i,index:s,name:o,...l}=t,d=ue(be,i),c=Ye(be,i),[g,f]=m.useState(null),k=te(a,x=>f(x)),r=g?d.form||!!g.closest("form"):!0,u=Tt(g),y=d.values[s],v=y===void 0?0:st(y,d.min,d.max),p=es(s,d.values.length),w=u?.[c.size],j=w?ss(w,v,c.direction):0;return m.useEffect(()=>{if(g)return d.thumbs.add(g),()=>{d.thumbs.delete(g)}},[g,d.thumbs]),e.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[c.startEdge]:`calc(${v}% + ${j}px)`},children:[e.jsx(ve.ItemSlot,{scope:t.__scopeSlider,children:e.jsx(re.span,{role:"slider","aria-label":t["aria-label"]||p,"aria-valuemin":d.min,"aria-valuenow":y,"aria-valuemax":d.max,"aria-orientation":d.orientation,"data-orientation":d.orientation,"data-disabled":d.disabled?"":void 0,tabIndex:d.disabled?void 0:0,...l,ref:k,style:y===void 0?{display:"none"}:t.style,onFocus:Q(t.onFocus,()=>{d.valueIndexToChangeRef.current=s})})}),r&&e.jsx(tt,{name:o??(d.name?d.name+(d.values.length>1?"[]":""):void 0),form:d.form,value:y},s)]})});et.displayName=be;var Zt="RadioBubbleInput",tt=m.forwardRef(({__scopeSlider:t,value:a,...i},s)=>{const o=m.useRef(null),l=te(o,s),d=Mt(a);return m.useEffect(()=>{const c=o.current;if(!c)return;const g=window.HTMLInputElement.prototype,k=Object.getOwnPropertyDescriptor(g,"value").set;if(d!==a&&k){const r=new Event("input",{bubbles:!0});k.call(c,a),c.dispatchEvent(r)}},[d,a]),e.jsx(re.input,{style:{display:"none"},...i,ref:l,defaultValue:a})});tt.displayName=Zt;function Qt(t=[],a,i){const s=[...t];return s[i]=a,s.sort((o,l)=>o-l)}function st(t,a,i){const l=100/(i-a)*(t-a);return Ge(l,[0,100])}function es(t,a){return a>2?`Value ${t+1} of ${a}`:a===2?["Minimum","Maximum"][t]:void 0}function ts(t,a){if(t.length===1)return 0;const i=t.map(o=>Math.abs(o-a)),s=Math.min(...i);return i.indexOf(s)}function ss(t,a,i){const s=t/2,l=Se([0,50],[0,s]);return(s-l(a)*i)*i}function as(t){return t.slice(0,-1).map((a,i)=>t[i+1]-a)}function ns(t,a){if(a>0){const i=as(t);return Math.min(...i)>=a}return!0}function Se(t,a){return i=>{if(t[0]===t[1]||a[0]===a[1])return a[0];const s=(a[1]-a[0])/(t[1]-t[0]);return a[0]+s*(i-t[0])}}function rs(t){return(String(t).split(".")[1]||"").length}function is(t,a){const i=Math.pow(10,a);return Math.round(t*i)/i}var os=We,cs=Ze,ls=Qe,ds=et;function ms({className:t,defaultValue:a,value:i,min:s=0,max:o=100,...l}){const d=m.useMemo(()=>Array.isArray(i)?i:Array.isArray(a)?a:[s,o],[i,a,s,o]);return e.jsxs(os,{"data-slot":"slider",defaultValue:a,value:i,min:s,max:o,className:ge("relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col",t),...l,children:[e.jsx(cs,{"data-slot":"slider-track",className:ge("bg-muted relative grow overflow-hidden rounded-full data-[orientation=horizontal]:h-4 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5"),children:e.jsx(ls,{"data-slot":"slider-range",className:ge("bg-primary absolute data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full")})}),Array.from({length:d.length},(c,g)=>e.jsx(ds,{"data-slot":"slider-thumb",className:"border-primary bg-background ring-ring/50 block size-4 shrink-0 rounded-full border shadow-sm transition-[color,box-shadow] hover:ring-4 focus-visible:ring-4 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"},g))]})}function us(t){return Array.from(new TextEncoder().encode(t)).map(a=>a.toString(16).padStart(2,"0")).join("")}async function hs(t){const a=crypto.getRandomValues(new Uint8Array(8)),i=Array.from(a).map(_=>_.toString(16).padStart(2,"0")).join(""),s=`GT-${t.eventId}-${i}`,o=`${s}|${t.eventId}|${t.attendeeId}|${t.purchaseTimestamp}|${t.secretSalt}|${t.blockchain?.txHash??""}`,l=await Et(o),d=`${s}|${t.eventId}|${t.attendeeId}|${t.purchaseTimestamp}|${l}`,[{PDFDocument:c,StandardFonts:g,rgb:f},k]=await Promise.all([Ee(()=>import("./index-C39EA6f3.js"),__vite__mapDeps([0,1,2])),Ee(()=>import("./browser-BFTG0pCe.js").then(_=>_.b),__vite__mapDeps([3,1,2]))]),r=await c.create(),u=r.addPage([600,850]),{width:y,height:v}=u.getSize(),p=await r.embedFont(g.Helvetica),w=await r.embedFont(g.HelveticaBold),j=t.theme?.bg??[.05,.05,.05],x=t.theme?.text??[.95,.95,.95],N=t.theme?.accent??[.3,.6,.95];if(u.drawRectangle({x:0,y:0,width:y,height:v,color:f(j[0],j[1],j[2])}),t.event.bannerUrl)try{const _=await fetch(t.event.bannerUrl),z=new Uint8Array(await _.arrayBuffer());let A;try{A=await r.embedPng(z)}catch{A=await r.embedJpg(z)}const M=y-80,J=M/A.width,X=A.height*J;u.drawImage(A,{x:40,y:v-60-X,width:M,height:X})}catch{}u.drawText("GatePass -IG",{x:40,y:v-40,size:18,font:w,color:f(x[0],x[1],x[2])}),u.drawText(t.event.name,{x:40,y:v-80,size:24,font:w,color:f(x[0],x[1],x[2])}),u.drawText(`${t.event.dateISO} • ${t.event.time} • ${t.event.venue}`,{x:40,y:v-110,size:12,font:p,color:f(x[0],x[1],x[2])}),u.drawText(`Attendee: ${t.attendee.name}`,{x:40,y:v-150,size:14,font:p,color:f(x[0],x[1],x[2])}),u.drawText(`Ticket Type: ${t.ticketType}`,{x:40,y:v-170,size:14,font:p,color:f(x[0],x[1],x[2])}),u.drawText(`Ticket ID: ${s}`,{x:40,y:v-190,size:14,font:p,color:f(x[0],x[1],x[2])});const b=document.createElement("canvas");await k.toCanvas(b,d,{errorCorrectionLevel:"H",width:280});const D=b.toDataURL("image/png"),W=Uint8Array.from(atob(D.split(",")[1]),_=>_.charCodeAt(0)),L=await r.embedPng(W);u.drawImage(L,{x:y-320,y:v-520,width:280,height:280}),u.drawText(l.slice(0,64),{x:y-320,y:v-225,size:6,font:p,color:f(x[0]*.8,x[1]*.8,x[2]*.8)});const K=(_=>{switch(_.toLowerCase()){case"vip":return f(.8,.7,0);case"general":return f(N[0],N[1],N[2]);case"early bird":return f(.2,.8,.4);default:return f(.4,.4,.4)}})(t.ticketType);u.drawRectangle({x:20,y:20,width:y-40,height:v-40,borderWidth:2,color:f(0,0,0),borderColor:K});const F="GatePass by IG - Lets give them access with tickets",T=9,I=p.widthOfTextAtSize(F,T);u.drawText(F,{x:Math.max(20,y-I-20),y:24,size:T,font:p,color:f(.7,.7,.7),opacity:.5}),t.blockchain?.txHash&&(u.drawText(`On-chain Tx: ${t.blockchain.txHash}`,{x:40,y:80,size:10,font:p,color:f(x[0],x[1],x[2])}),u.drawText(`Verify: https://explorer/${t.blockchain.chain??"polygon"}/tx/${t.blockchain.txHash}`,{x:40,y:65,size:10,font:p,color:f(x[0],x[1],x[2])}));const q=crypto.randomUUID();r.setTitle(`GatePass Ticket ${s}`),r.setSubject("Event Ticket"),r.setKeywords([`UUID:${q}`,`SEC:${us(l.slice(0,16))}`]),r.setProducer("GatePass -IG"),r.setCreator("GatePass Ticket Generator");const Y=await r.save();return{ticketId:s,pdfBytes:Y}}const at={};async function nt(t){return new Promise((a,i)=>{if(document.querySelector(`script[src="${t}"]`)){a();return}const s=document.createElement("script");s.src=t,s.async=!0,s.onload=()=>a(),s.onerror=()=>i(new Error(`Failed to load script ${t}`)),document.head.appendChild(s)})}async function xs(t){const a=at?.VITE_PAYSTACK_PUBLIC_KEY;if(!a)return{ok:!1,error:"Missing Paystack public key (VITE_PAYSTACK_PUBLIC_KEY)."};await nt("https://js.paystack.co/v1/inline.js");const i=t.reference??`GP-${Date.now()}`,s=window.PaystackPop?.setup?.({key:a,email:t.email,amount:Math.round(t.amount*100),currency:t.currency??"NGN",ref:i,metadata:t.metadata,callback:o=>{t.onSuccess?.(o)},onClose:()=>{t.onCancel?.()}});return s?(s.openIframe(),{ok:!0}):{ok:!1,error:"Paystack inline SDK not available."}}async function fs(t){const a=at?.VITE_FLUTTERWAVE_PUBLIC_KEY;if(!a)return{ok:!1,error:"Missing Flutterwave public key (VITE_FLUTTERWAVE_PUBLIC_KEY)."};await nt("https://checkout.flutterwave.com/v3.js");const i=t.reference??`GP-${Date.now()}`,s=window.FlutterwaveCheckout;return s?(s({public_key:a,tx_ref:i,amount:t.amount,currency:t.currency??"NGN",customer:{email:t.email,phone_number:t.phone??"",name:t.name??""},callback:o=>{t.onSuccess?.(o)},onclose:()=>{t.onCancel?.()}}),{ok:!0}):{ok:!1,error:"Flutterwave checkout SDK not available."}}async function ps(){return{ok:!1,error:"M-Pesa STK Push requires a server endpoint. Configure server-side integration."}}const Ke=[{id:1,title:"Tech Conference 2024",description:"Join industry leaders for cutting-edge tech talks and networking.",date:"2024-03-15",time:"09:00 AM - 06:00 PM",venue:"Convention Center, SF",category:"Technology",niche:"AI",location:{city:"San Francisco",lat:37.784,lng:-122.401},price:150,image:"/api/placeholder/400/250",organizer:"TechEvents Inc",attendees:450,maxCapacity:500,rating:4.8,verified:!0,ticketTiers:[{id:1,name:"Early Bird",price:120,available:50,description:"Limited time offer"},{id:2,name:"General",price:150,available:200,description:"Standard admission"},{id:3,name:"VIP",price:300,available:25,description:"Premium access + networking"}]},{id:2,title:"Music Festival Summer",description:"Three days of amazing music with top artists from around the world.",date:"2024-06-20",time:"12:00 PM - 11:00 PM",venue:"Golden Gate Park",category:"Music",niche:"Festival",location:{city:"San Francisco",lat:37.7694,lng:-122.4862},price:120,image:"/api/placeholder/400/250",organizer:"Summer Sounds",attendees:8500,maxCapacity:1e4,rating:4.9,verified:!0,ticketTiers:[{id:1,name:"General Admission",price:120,available:1500,description:"Access to all stages"},{id:2,name:"VIP Experience",price:350,available:200,description:"Front row + backstage access"}]},{id:3,title:"Startup Pitch Night",description:"Watch innovative startups pitch their ideas to investors.",date:"2024-02-28",time:"06:00 PM - 09:00 PM",venue:"WeWork Downtown",category:"Business",niche:"Startup",location:{city:"San Francisco",lat:37.788,lng:-122.402},price:30,image:"/api/placeholder/400/250",organizer:"Startup Hub",attendees:85,maxCapacity:100,rating:4.7,verified:!0,ticketTiers:[{id:1,name:"Standard",price:30,available:15,description:"General seating"}]}];function Ds({eventId:t,onBack:a,onPurchaseComplete:i}){const[s,o]=m.useState(null),[l,d]=m.useState(""),[c,g]=m.useState(1),[f,k]=m.useState("crypto"),[r,u]=m.useState("none"),[y,v]=m.useState("NGN"),[p,w]=m.useState(""),[j,x]=m.useState(""),[N,b]=m.useState(!1),[D,W]=m.useState(0),[L,ie]=m.useState(0),K=Dt(),[F,T]=m.useState(At()||""),[I,q]=m.useState(""),[Y,_]=m.useState("all"),[z,A]=m.useState("all"),[M,J]=m.useState(null),[X,rt]=m.useState(0),[Ne,G]=m.useState(!1),it=Array.from(new Set(Ke.map(n=>n.niche))).sort();function oe(n){return n*Math.PI/180}function ke(n,h){const R=oe(h.lat-n.lat),B=oe(h.lng-n.lng),H=oe(n.lat),P=oe(h.lat),S=Math.sin(R/2),ae=Math.sin(B/2);return 6371*(2*Math.asin(Math.sqrt(S*S+Math.cos(H)*Math.cos(P)*ae*ae)))}const Ce=Ke.filter(n=>{const h=n.title.toLowerCase().includes(I.toLowerCase())||n.description.toLowerCase().includes(I.toLowerCase()),C=Y==="all"||n.category===Y,R=z==="all"||n.niche===z,B=!M||X===0?!0:ke(M,{lat:n.location.lat,lng:n.location.lng})<=X;return h&&C&&R&&B}),ot=async()=>{if(!s||!l)return;G(!0);const n=s.ticketTiers.find(P=>P.id.toString()===l),h=Pe,C=h*.025,R=Re(h,K,F),B=n&&c>=10?n.price*2:0,H=Math.max(0,h+C-R-B+D+L);try{if(f==="fiat"){if(r==="paystack"){const P=await xs({email:p||"buyer@example.com",amount:Number(H.toFixed(2)),currency:y,reference:`GP-${s.id}-${Date.now()}`,metadata:{eventId:s.id,tierId:l},onSuccess:async()=>{await he(s,n)},onCancel:()=>{$.info("Payment canceled."),G(!1)}});P.ok||($.error(P.error||"Unable to start Paystack checkout."),G(!1));return}if(r==="flutterwave"){const P=await fs({email:p||"buyer@example.com",amount:Number(H.toFixed(2)),currency:y,phone:j||void 0,name:p?p.split("@")[0]:"Attendee",reference:`GP-${s.id}-${Date.now()}`,onSuccess:async()=>{await he(s,n)},onCancel:()=>{$.info("Payment canceled."),G(!1)}});P.ok||($.error(P.error||"Unable to start Flutterwave checkout."),G(!1));return}if(r==="mpesa"){const P=await ps();$.error(P.error||"M-Pesa not configured."),G(!1);return}if(r==="stripe"){$.error("Stripe not configured."),G(!1);return}$.error("Please select a local payment gateway."),G(!1);return}await new Promise(P=>setTimeout(P,1500)),await he(s,n)}catch(P){console.error("Purchase error:",P),$.error("Purchase failed. Please try again."),G(!1)}};async function he(n,h){$.success("Ticket purchased successfully!",{description:"Your NFT ticket has been minted to your wallet."});try{const C=document.createElement("div");C.style.position="fixed",C.style.inset="0",C.style.pointerEvents="none",C.style.zIndex="1000",document.body.appendChild(C);const R=["#FFD166","#06D6A0","#EF476F","#118AB2","#8338EC"],B=Array.from({length:140},(H,P)=>{const S=document.createElement("div");S.style.position="absolute",S.style.width=Math.round(Math.random()*6+4)+"px",S.style.height=Math.round(Math.random()*12+6)+"px",S.style.background=R[P%R.length],S.style.left=Math.round(Math.random()*100)+"%",S.style.top="-20px",S.style.opacity="0.9",S.style.transform=`rotate(${Math.round(Math.random()*360)}deg)`,C.appendChild(S);const ae=Math.random()*1200+1600,Me=(Math.random()*2-1)*120,lt=[{transform:S.style.transform,top:"-20px"},{transform:`translate(${Me}px, 0px) rotate(${Math.round(Math.random()*360)}deg)`,top:"100vh"}];return S.animate(lt,{duration:ae,easing:"cubic-bezier(0.22, 1, 0.36, 1)",fill:"forwards"}),setTimeout(()=>{S.remove()},ae+200),S});setTimeout(()=>{C.remove()},2400)}catch{}try{try{const{data:C}=await _t.auth.getSession(),R=C?.session?.access_token;if(R&&h){const B=await fetch("/make-server-f7f2fbf2/tickets/purchase",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${R}`},body:JSON.stringify({eventId:String(n.id),tierId:String(h.id),quantity:c,paymentMethod:f})});if(!B.ok){const H=await B.text();console.warn("Server purchase record failed:",H)}}}catch(C){console.warn("Skipping server purchase recording:",C)}if(h){const C={eventId:String(n.id),attendeeId:"demo-attendee",ticketType:h.name,event:{name:n.title,dateISO:n.date,time:n.time,venue:n.venue,bannerUrl:void 0},attendee:{name:p?p.split("@")[0]:"Attendee"},purchaseTimestamp:Date.now(),blockchain:{chain:"polygon",txHash:"0xDEMO"},secretSalt:"demo-salt"},{ticketId:R,pdfBytes:B}=await hs(C),H=new Blob([new Uint8Array(B)],{type:"application/pdf"}),P=URL.createObjectURL(H),S=document.createElement("a");S.href=P,S.download=`GatePass_Ticket_${R}.pdf`,document.body.appendChild(S),S.click(),S.remove(),URL.revokeObjectURL(P)}}catch(C){console.error("PDF generation error:",C),$.error("Ticket generated, but download failed.")}G(!1),o(null),d(""),g(1),i()}const O=s?.ticketTiers.find(n=>n.id.toString()===l),Pe=O?O.price*c:0,xe=Pe,Te=xe*.025,fe=Re(xe,K,F),pe=O&&c>=10?O.price*2:0,ct=Math.max(0,xe+Te-fe-pe),Z=Math.max(0,ct+D+L);return e.jsx("div",{className:"min-h-screen bg-background p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-8",children:[e.jsxs(U,{variant:"ghost",onClick:a,className:"flex items-center space-x-2",children:[e.jsx(ut,{className:"h-4 w-4"}),e.jsx("span",{children:"Back"})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Browse Events"}),e.jsx("p",{className:"text-muted-foreground",children:"Find and purchase tickets for upcoming events"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(Be,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(ne,{placeholder:"Search events...",value:I,onChange:n=>q(n.target.value),className:"pl-10"})]})}),e.jsxs(ce,{onValueChange:_,children:[e.jsxs(le,{children:[e.jsx(Le,{className:"h-4 w-4 mr-2"}),e.jsx(de,{placeholder:"All Categories"})]}),e.jsxs(me,{children:[e.jsx(E,{value:"all",children:"All Categories"}),e.jsx(E,{value:"Technology",children:"Technology"}),e.jsx(E,{value:"Music",children:"Music"}),e.jsx(E,{value:"Business",children:"Business"}),e.jsx(E,{value:"Art",children:"Art"}),e.jsx(E,{value:"Sports",children:"Sports"})]})]}),e.jsxs(ce,{onValueChange:A,children:[e.jsxs(le,{children:[e.jsx(Le,{className:"h-4 w-4 mr-2"}),e.jsx(de,{placeholder:"All Niches"})]}),e.jsxs(me,{children:[e.jsx(E,{value:"all",children:"All Niches"}),it.map(n=>e.jsx(E,{value:n,children:n},n))]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8",children:[e.jsx(U,{variant:"outline",onClick:()=>{if(!("geolocation"in navigator)){$.error("Geolocation not supported in this browser.");return}navigator.geolocation.getCurrentPosition(n=>{J({lat:n.coords.latitude,lng:n.coords.longitude}),$.success("Location synced. Showing nearby events.")},n=>{console.error("Geolocation error:",n),$.error("Unable to fetch location. Please allow access.")},{enableHighAccuracy:!0,timeout:1e4})},children:"Use My Location"}),e.jsxs(ce,{onValueChange:n=>rt(Number(n)),children:[e.jsxs(le,{children:[e.jsx(je,{className:"h-4 w-4 mr-2"}),e.jsx(de,{placeholder:"Any distance"})]}),e.jsxs(me,{children:[e.jsx(E,{value:String(0),children:"Any distance"}),e.jsx(E,{value:String(5),children:"Within 5 km"}),e.jsx(E,{value:String(10),children:"Within 10 km"}),e.jsx(E,{value:String(25),children:"Within 25 km"}),e.jsx(E,{value:String(50),children:"Within 50 km"})]})]}),M&&e.jsxs("div",{className:"text-sm text-muted-foreground flex items-center",children:[e.jsx(je,{className:"h-4 w-4 mr-2"}),"Location set. Filtering within ",X||"any"," km."]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Ce.map(n=>e.jsxs(_e,{className:"overflow-hidden hover:shadow-lg transition-shadow cursor-pointer",children:[e.jsx("div",{className:"aspect-video bg-gradient-to-br from-primary/20 to-secondary/20 flex items-center justify-center",children:e.jsx($e,{className:"h-16 w-16 text-primary/50"})}),e.jsx(ht,{className:"pb-3",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(xt,{className:"text-lg line-clamp-1",children:n.title}),e.jsx(ft,{className:"line-clamp-2",children:n.description})]}),n.verified&&e.jsxs(ye,{variant:"outline",className:"ml-2",children:[e.jsx(It,{className:"h-3 w-3 mr-1"}),"Verified"]})]})}),e.jsxs(De,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx($e,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:n.date})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Rt,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:n.time})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(je,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{className:"line-clamp-1",children:[n.venue,M?` • ${n.location.city}`:""]})]}),M&&e.jsxs("div",{className:"text-xs text-muted-foreground pl-6",children:["~",Math.round(ke(M,{lat:n.location.lat,lng:n.location.lng}))," km away"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ht,{className:"h-4 w-4 text-yellow-500 fill-current"}),e.jsx("span",{className:"text-sm",children:n.rating}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["(",n.attendees,")"]})]}),e.jsxs(ye,{variant:"secondary",children:[n.category," • ",n.niche]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"From"}),e.jsxs("p",{className:"font-bold",children:["$",Math.min(...n.ticketTiers.map(h=>h.price))]})]}),e.jsxs(pt,{children:[e.jsx(gt,{asChild:!0,children:e.jsx(U,{onClick:()=>o(n),children:"Buy Tickets"})}),e.jsxs(yt,{className:"max-w-2xl",children:[e.jsxs(jt,{children:[e.jsxs(vt,{className:"flex items-center space-x-2",children:[e.jsx(Fe,{className:"h-5 w-5"}),e.jsx("span",{children:"Purchase Tickets"})]}),e.jsxs(wt,{children:[s?.title," • ",s?.date]})]}),s&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(V,{className:"text-base font-medium",children:"Select Ticket Type"}),e.jsx("div",{className:"grid gap-3 mt-2",children:s.ticketTiers.map(h=>e.jsx("div",{className:`border rounded-lg p-4 cursor-pointer transition-colors ${l===h.id.toString()?"border-primary bg-primary/5":"border-border hover:border-primary/50"}`,onClick:()=>d(h.id.toString()),children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:h.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:h.description})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-bold",children:["$",h.price]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[h.available," left"]})]})]})},h.id))})]}),l&&e.jsxs("div",{children:[e.jsx(V,{className:"text-base font-medium",children:"Quantity"}),e.jsxs("div",{className:"flex items-center space-x-2 mt-2",children:[e.jsx(U,{variant:"outline",size:"sm",onClick:()=>g(Math.max(1,c-1)),disabled:c<=1,children:e.jsx(Gt,{className:"h-3 w-3"})}),e.jsx("span",{className:"w-12 text-center",children:c}),e.jsx(U,{variant:"outline",size:"sm",onClick:()=>g(Math.min(12,c+1)),disabled:c>=12||O&&c>=O.available,children:e.jsx($t,{className:"h-3 w-3"})})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Group discount applies at 10+ tickets"})]}),l&&e.jsxs("div",{children:[e.jsx(V,{className:"text-base font-medium",children:"Payment Method"}),e.jsxs(St,{value:f,onValueChange:h=>k(h),className:"mt-2",children:[e.jsxs(Nt,{className:"grid w-full grid-cols-2",children:[e.jsxs(Ae,{value:"crypto",className:"flex items-center space-x-2",children:[e.jsx(bt,{className:"h-4 w-4"}),e.jsx("span",{children:"Crypto"})]}),e.jsxs(Ae,{value:"fiat",className:"flex items-center space-x-2",children:[e.jsx(Lt,{className:"h-4 w-4"}),e.jsx("span",{children:"Credit Card"})]})]}),e.jsx(Ie,{value:"crypto",className:"space-y-3",children:e.jsxs("div",{className:"bg-muted/30 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(ze,{className:"h-4 w-4 text-blue-500"}),e.jsx("span",{className:"font-medium",children:"Crypto Payment"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Pay with ETH, MATIC, or USDC. Tickets are minted as NFTs directly to your wallet."})]})}),e.jsx(Ie,{value:"fiat",className:"space-y-3",children:e.jsxs("div",{className:"bg-muted/30 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(ze,{className:"h-4 w-4 text-blue-500"}),e.jsx("span",{className:"font-medium",children:"Local Currency Payment"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Pay with Paystack or Flutterwave in NGN, GHS, KES, or ZAR. If M-Pesa is selected, a server configuration is required."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mt-3",children:[e.jsxs("div",{children:[e.jsx(V,{className:"text-sm",children:"Currency"}),e.jsxs(ce,{value:y,onValueChange:h=>v(h),children:[e.jsx(le,{children:e.jsx(de,{placeholder:"Select currency"})}),e.jsxs(me,{children:[e.jsx(E,{value:"NGN",children:"NGN (₦)"}),e.jsx(E,{value:"GHS",children:"GHS (₵)"}),e.jsx(E,{value:"KES",children:"KES (KSh)"}),e.jsx(E,{value:"ZAR",children:"ZAR (R)"})]})]})]}),e.jsxs("div",{children:[e.jsx(V,{className:"text-sm",children:"Email"}),e.jsx(ne,{placeholder:"you@example.com",value:p,onChange:h=>w(h.target.value)})]}),e.jsxs("div",{children:[e.jsx(V,{className:"text-sm",children:"Phone (optional)"}),e.jsx(ne,{placeholder:"e.g. 0803 123 4567",value:j,onChange:h=>x(h.target.value)})]})]}),K&&e.jsxs("div",{className:"mt-3 grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(V,{className:"text-sm",children:"Promo Code"}),e.jsx(ne,{placeholder:K.code,value:F,onChange:h=>T(h.target.value)})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs(ye,{variant:"secondary",className:"w-full justify-center",children:[K.name," - ",K.discountPercent,"% off"]})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 mt-3",children:[e.jsx(U,{type:"button",variant:r==="paystack"?"default":"outline",onClick:()=>u("paystack"),children:"Paystack"}),e.jsx(U,{type:"button",variant:r==="flutterwave"?"default":"outline",onClick:()=>u("flutterwave"),children:"Flutterwave"}),e.jsx(U,{type:"button",variant:r==="mpesa"?"default":"outline",onClick:()=>u("mpesa"),children:"M-Pesa"}),e.jsx(U,{type:"button",variant:r==="stripe"?"default":"outline",onClick:()=>u("stripe"),children:"Stripe"})]})]})})]})]}),l&&e.jsxs("div",{className:"border rounded-lg p-4 bg-muted/30",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Order Summary"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:[O?.name," × ",c]}),e.jsxs("span",{children:["$",(O?.price||0)*c]})]}),e.jsxs("div",{className:"flex justify-between text-sm text-muted-foreground",children:[e.jsx("span",{children:"Platform fee"}),e.jsxs("span",{children:["$",Te.toFixed(2)]})]}),fe>0&&e.jsxs("div",{className:"flex justify-between text-sm text-green-600",children:[e.jsx("span",{children:"Promo discount"}),e.jsxs("span",{children:["- $",fe.toFixed(2)]})]}),pe>0&&e.jsxs("div",{className:"flex justify-between text-sm text-green-600",children:[e.jsx("span",{children:"Group discount"}),e.jsxs("span",{children:["- $",pe.toFixed(2)]})]}),D>0&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Donation"}),e.jsxs("span",{children:["+ $",D.toFixed(2)]})]}),L>0&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Tip"}),e.jsxs("span",{children:["+ $",L.toFixed(2)]})]}),e.jsxs("div",{className:"border-t pt-2 flex justify-between font-medium",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["$",Z.toFixed(2)]})]})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(V,{className:"text-sm",children:"Enable Installments"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(kt,{checked:N,onCheckedChange:b}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Pay in 4"})]}),N&&e.jsxs("div",{className:"text-xs mt-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Now"}),e.jsxs("span",{children:["$",(Z/4).toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"In 30 days"}),e.jsxs("span",{children:["$",(Z/4).toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"In 60 days"}),e.jsxs("span",{children:["$",(Z/4).toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"In 90 days"}),e.jsxs("span",{children:["$",(Z/4).toFixed(2)]})]})]})]}),e.jsxs("div",{children:[e.jsx(V,{className:"text-sm",children:"Donation"}),e.jsxs("div",{className:"mt-2",children:[e.jsx(ms,{value:[D],onValueChange:h=>W(Number(h[0]||0)),max:100,step:1}),e.jsxs("div",{className:"text-xs mt-1",children:["$",D.toFixed(0)]})]}),e.jsx(V,{className:"text-sm mt-3",children:"Tip"}),e.jsx(ne,{type:"number",value:L,onChange:h=>ie(Number(h.target.value||0)),placeholder:"$0"})]})]})]}),e.jsx(U,{onClick:ot,disabled:!l||Ne,className:"w-full flex items-center space-x-2",children:Ne?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),e.jsx("span",{children:"Processing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Fe,{className:"h-4 w-4"}),e.jsxs("span",{children:["Purchase Tickets — $",Z.toFixed(2)]})]})})]})]})]})]})]})]},n.id))}),Ce.length===0&&e.jsx(_e,{children:e.jsxs(De,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(Be,{className:"h-16 w-16 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Events Found"}),e.jsx("p",{className:"text-muted-foreground text-center",children:"Try adjusting your search criteria or browse all categories."})]})})]})})}export{Ds as TicketPurchase};
